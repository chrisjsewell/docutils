#!/usr/bin/env python
import sys
import optparse
import os


import rst2odp
import docutils.core

__version__ = "0.1"
__author__ = "matt harrison"
__email__ = "matthewharrison@gmail.com"


def main(prog_args):
    parser = optparse.OptionParser(version=__version__)
    opt, args = parser.parse_args(prog_args)
    
    # change to directory of source
    dirname = os.path.dirname(prog_args[1])
    os.chdir(dirname)
    basename = os.path.basename(prog_args[1])
    prog_args[1] = basename

    writer = rst2odp.Writer()
    docutils.core.publish_cmdline(writer=writer)


if __name__ == "__main__":
    sys.exit(main(sys.argv) or 0)

