<?xml version="1.0" encoding="utf-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="Docutils 0.5: http://docutils.sourceforge.net/" />
<title>Odtwriter for Docutils</title>
<meta name="author" content="Dave Kuhlman" />
<meta name="date" content="Jan. 5, 2007" />
<meta name="copyright" content="Copyright (c) 2006 Dave Kuhlman.  All Rights Reserved. This software is subject to the provisions of the MIT License http://www.opensource.org/licenses/mit-license.php." />
<style type="text/css">

/* nuxeo doc css */
/* $Id$ */

body {
  font: 90% 'Lucida Grande', Verdana, Geneva, Lucida, Arial, Helvetica, sans-serif;
  background: #ffffff;
  color: black;
  margin: 2em;
  padding: 2em;
}

a[href] {
  color: #436976;
  background-color: transparent;
}

a.toc-backref {
  text-decoration: none;
}

h1 a[href] {
  text-decoration: none;
  color: #fcb100;
  background-color: transparent;
}

a.strong {
  font-weight: bold;
}

img {
  margin: 0;
  border: 0;
}

p {
  margin: 0.5em 0 1em 0;
  line-height: 1.5em;
}
p a {
  text-decoration: underline;
}
p a:visited {
  color: purple;
  background-color: transparent;
}
p a:active {
  color: red;
  background-color: transparent;
}
a:hover {
  text-decoration: none;
}
p img {
  border: 0;
  margin: 0;
}

h1, h2, h3, h4, h5, h6 {
  color: #003a6b;
  background-color: transparent;
  font: 100% 'Lucida Grande', Verdana, Geneva, Lucida, Arial, Helvetica, sans-serif;
  margin: 0;
  padding-top: 0.5em;
}

h1 {
  font-size: 160%;
  margin-bottom: 0.5em;
  border-bottom: 1px solid #fcb100;
}
h2 {
  font-size: 140%;
  margin-bottom: 0.5em;
  border-bottom: 1px solid #aaa;
}
h3 {
  font-size: 130%;
  margin-bottom: 0.5em;
}
h4 {
  font-size: 110%;
  font-weight: bold;
}
h5 {
  font-size: 100%;
  font-weight: bold;
}
h6 {
  font-size: 80%;
  font-weight: bold;
}

ul a, ol a {
  text-decoration: underline;
}

dt {
  font-weight: bold;
}
dt a {
  text-decoration: none;
}

dd {
  line-height: 1.5em;
  margin-bottom: 1em;
}

legend {
  background: #ffffff;
  padding: 0.5em;
}

form {
  margin: 0;
}


dl.form {
  margin: 0;
  padding: 1em;
}

dl.form dt {
  width: 30%;
  float: left;
  margin: 0;
  padding: 0 0.5em 0.5em 0;
  text-align: right;
}

input {
  font: 100% 'Lucida Grande', Verdana, Geneva, Lucida, Arial, Helvetica, sans-serif;
  color: black;
  background-color: white;
  vertical-align: middle;
}

abbr, acronym, .explain {
  color: black;
  background-color: transparent;
}

q, blockquote {
}

code, pre {
  font-family: monospace;
  font-size: 1.2em;
  display: block;
  padding: 10px;
  border: 1px solid #838183;
  background-color: #eee;
  color: #000;
  overflow: auto;
  margin: 0.5em 1em;
}

tt.docutils {
  background-color: #eeeeee;
}

</style>
</head>
<body>
<div class="document" id="odtwriter-for-docutils">
<h1 class="title">Odtwriter for Docutils</h1>
<table class="docinfo" frame="void" rules="none">
<col class="docinfo-name" />
<col class="docinfo-content" />
<tbody valign="top">
<tr><th class="docinfo-name">Author:</th>
<td>Dave Kuhlman</td></tr>
<tr><th class="docinfo-name">Address:</th>
<td><pre class="address">
<a class="first reference" href="mailto:dkuhlman&#64;rexx.com">dkuhlman&#64;rexx.com</a>
<a class="last reference" href="http://www.rexx.com/~dkuhlman">http://www.rexx.com/~dkuhlman</a>
</pre>
</td></tr>
<tr><th class="docinfo-name">Revision:</th>
<td>1.0c</td></tr>
<tr><th class="docinfo-name">Date:</th>
<td>Jan. 5, 2007</td></tr>
<tr><th class="docinfo-name">Copyright:</th>
<td>Copyright (c) 2006 Dave Kuhlman.  All Rights Reserved.
This software is subject to the provisions of the MIT License
<a class="reference" href="http://www.opensource.org/licenses/mit-license.php">http://www.opensource.org/licenses/mit-license.php</a>.</td></tr>
</tbody>
</table>
<div class="abstract topic">
<p class="topic-title first">Abstract</p>
<p>This document describes the Docutils odtwriter.</p>
</div>
<div class="contents topic">
<p class="topic-title first"><a id="contents" name="contents">Contents</a></p>
<ul class="auto-toc simple">
<li><a class="reference" href="#introduction" id="id1" name="id1">1&nbsp;&nbsp;&nbsp;Introduction</a></li>
<li><a class="reference" href="#how-to-install-it" id="id2" name="id2">2&nbsp;&nbsp;&nbsp;How to Install It</a><ul class="auto-toc">
<li><a class="reference" href="#where-to-get-it" id="id3" name="id3">2.1&nbsp;&nbsp;&nbsp;Where to get it</a></li>
<li><a class="reference" href="#requirements" id="id4" name="id4">2.2&nbsp;&nbsp;&nbsp;Requirements</a></li>
<li><a class="reference" href="#installation" id="id5" name="id5">2.3&nbsp;&nbsp;&nbsp;Installation</a></li>
</ul>
</li>
<li><a class="reference" href="#how-to-use-it" id="id6" name="id6">3&nbsp;&nbsp;&nbsp;How to Use It</a><ul class="auto-toc">
<li><a class="reference" href="#command-line-flags" id="id7" name="id7">3.1&nbsp;&nbsp;&nbsp;Command line flags</a></li>
</ul>
</li>
<li><a class="reference" href="#styles" id="id8" name="id8">4&nbsp;&nbsp;&nbsp;Styles</a><ul class="auto-toc">
<li><a class="reference" href="#styles-used-by-odtwriter" id="id9" name="id9">4.1&nbsp;&nbsp;&nbsp;Styles used by odtwriter</a><ul class="auto-toc">
<li><a class="reference" href="#paragraph-styles" id="id10" name="id10">4.1.1&nbsp;&nbsp;&nbsp;Paragraph styles</a></li>
<li><a class="reference" href="#character-styles" id="id11" name="id11">4.1.2&nbsp;&nbsp;&nbsp;Character styles</a></li>
</ul>
</li>
<li><a class="reference" href="#table-styles" id="id12" name="id12">4.2&nbsp;&nbsp;&nbsp;Table styles</a></li>
</ul>
</li>
<li><a class="reference" href="#hints-and-suggestions" id="id13" name="id13">5&nbsp;&nbsp;&nbsp;Hints and Suggestions</a><ul class="auto-toc">
<li><a class="reference" href="#table-of-contents" id="id14" name="id14">5.1&nbsp;&nbsp;&nbsp;Table of contents</a></li>
<li><a class="reference" href="#syntax-highlighting" id="id15" name="id15">5.2&nbsp;&nbsp;&nbsp;Syntax highlighting</a><ul class="auto-toc">
<li><a class="reference" href="#controlling-syntax-highlighting-within-a-document" id="id16" name="id16">5.2.1&nbsp;&nbsp;&nbsp;Controlling syntax highlighting within a document</a></li>
</ul>
</li>
<li><a class="reference" href="#the-container-directive" id="id17" name="id17">5.3&nbsp;&nbsp;&nbsp;The container directive</a></li>
<li><a class="reference" href="#the-table-directive" id="id18" name="id18">5.4&nbsp;&nbsp;&nbsp;The table directive</a></li>
</ul>
</li>
</ul>
</div>
<div class="section">
<h1><a class="toc-backref" href="#id1" id="introduction" name="introduction">1&nbsp;&nbsp;&nbsp;Introduction</a></h1>
<p>What it does -- <tt class="docutils literal"><span class="pre">rst2odt.py/odtwriter.py</span></tt> translates reST
(reStructuredText) into a Open Document Format <tt class="docutils literal"><span class="pre">.odt</span></tt> file.  You
can learn more about the ODF format here:</p>
<ul class="simple">
<li><a class="reference" href="http://www.oasis-open.org/committees/tc_home.php?wg_abbrev=office">OASIS Open Document Format for Office Applications
(OpenDocument) TC</a></li>
<li><a class="reference" href="http://en.wikipedia.org/wiki/OpenDocument">Open Document at Wikipedia</a></li>
</ul>
<p>You should be able to open documents (.odt files) generated with
<tt class="docutils literal"><span class="pre">rst2odt.py</span></tt> in <tt class="docutils literal"><span class="pre">OpenOffice/oowriter</span></tt>.  I use OpenOffice version
2.0 in my testing.</p>
</div>
<div class="section">
<h1><a class="toc-backref" href="#id2" id="how-to-install-it" name="how-to-install-it">2&nbsp;&nbsp;&nbsp;How to Install It</a></h1>
<div class="section">
<h2><a class="toc-backref" href="#id3" id="where-to-get-it" name="where-to-get-it">2.1&nbsp;&nbsp;&nbsp;Where to get it</a></h2>
<p><tt class="docutils literal"><span class="pre">odtwriter</span></tt> is available via Subversion from
the Docutils repository under
<tt class="docutils literal"><span class="pre">docutils/sandbox/dkuhlman/OpenDocument/</span></tt>. The following will
download Docutils including <tt class="docutils literal"><span class="pre">odtwriter</span></tt> and associated files into
your current directory:</p>
<pre class="literal-block">
$ svn checkout svn://svn.berlios.de/docutils/trunk docutils
</pre>
<p>For more information about access to the Docutils Subversion
repository, see:
<a class="reference" href="http://docutils.sourceforge.net/docs/dev/repository.html">http://docutils.sourceforge.net/docs/dev/repository.html</a>.</p>
</div>
<div class="section">
<h2><a class="toc-backref" href="#id4" id="requirements" name="requirements">2.2&nbsp;&nbsp;&nbsp;Requirements</a></h2>
<p><tt class="docutils literal"><span class="pre">odtwriter</span></tt> requires:</p>
<ul>
<li><p class="first">Python</p>
</li>
<li><p class="first">A sufficiently recent version of Docutils.</p>
</li>
<li><p class="first">Either of the following:</p>
<ul class="simple">
<li>ElementTree -- See: <a class="reference" href="http://effbot.org/zone/element-index.htm">http://effbot.org/zone/element-index.htm</a></li>
<li>Lxml -- See: <a class="reference" href="http://codespeak.net/lxml/">http://codespeak.net/lxml/</a></li>
</ul>
<p><tt class="docutils literal"><span class="pre">odtwriter</span></tt> will try first to use Lxml, and if it is not
installed will use ElementTree.</p>
</li>
<li><p class="first">Optional -- <a class="reference" href="http://pygments.pocoo.org/">Pygments</a> is required for syntax highlighting of
code in literal blocks.  See section <a class="reference" href="#syntax-highlighting">Syntax highlighting</a>.</p>
</li>
</ul>
</div>
<div class="section">
<h2><a class="toc-backref" href="#id5" id="installation" name="installation">2.3&nbsp;&nbsp;&nbsp;Installation</a></h2>
<p>Install <tt class="docutils literal"><span class="pre">odtwriter</span></tt> with the standard Python installation
commands:</p>
<pre class="literal-block">
$ python setup.py build
$ python setup.py install       # possibly as root
</pre>
<p>This will install <tt class="docutils literal"><span class="pre">rst2odt.py</span></tt> in your <tt class="docutils literal"><span class="pre">bin</span></tt> directory and the
odtwriter and the styles file under <tt class="docutils literal"><span class="pre">docutils/writers/odtwriter</span></tt>
within your Docutils installation.</p>
</div>
</div>
<div class="section">
<h1><a class="toc-backref" href="#id6" id="how-to-use-it" name="how-to-use-it">3&nbsp;&nbsp;&nbsp;How to Use It</a></h1>
<p>Run it from the command line as follows:</p>
<pre class="literal-block">
$ rst2odt.py myinput.txt myoutput.odt
</pre>
<p>To see usage information and to learn about command line flags
that you can use, run the following:</p>
<pre class="literal-block">
$ rst2odt.py --help
</pre>
<p>Examples:</p>
<pre class="literal-block">
$ rst2odt.py -s -g python_comments.txt python_comments.odt

$ rst2odt.py --source-url=odtwriter.txt --generator --stylesheet-path=/myconfigs/styles.odt odtwriter.txt odtwriter.odt
</pre>
<div class="section">
<h2><a class="toc-backref" href="#id7" id="command-line-flags" name="command-line-flags">3.1&nbsp;&nbsp;&nbsp;Command line flags</a></h2>
<p>The following command line flags are specific to <tt class="docutils literal"><span class="pre">odtwriter</span></tt>:</p>
<table class="docutils option-list" frame="void" rules="none">
<col class="option" />
<col class="description" />
<tbody valign="top">
<tr><td class="option-group" colspan="2">
<kbd><span class="option">--stylesheet=<var>&lt;URL&gt;</var></span></kbd></td>
</tr>
<tr><td>&nbsp;</td><td>Specify a stylesheet URL, used verbatim.  Overrides
--stylesheet-path.</td></tr>
<tr><td class="option-group" colspan="2">
<kbd><span class="option">--stylesheet-path=<var>&lt;file&gt;</var></span></kbd></td>
</tr>
<tr><td>&nbsp;</td><td>Specify a stylesheet file, relative to the current
working directory.  The path is adjusted relative to
the output ODF file.  Overrides --stylesheet.
Default: &quot;/usr/local/lib/python2.5/site-
packages/docutils/writers/odtwriter/styles.odt&quot;</td></tr>
<tr><td class="option-group" colspan="2">
<kbd><span class="option">--cloak-email-addresses</span></kbd></td>
</tr>
<tr><td>&nbsp;</td><td>Obfuscate email addresses to confuse harvesters while
still keeping email links usable with standards-
compliant browsers.</td></tr>
<tr><td class="option-group" colspan="2">
<kbd><span class="option">--table-border-thickness=<var>TABLE_BORDER_THICKNESS</var></span></kbd></td>
</tr>
<tr><td>&nbsp;</td><td>Specify the thickness of table borders in thousands of
a cm.  Default is 35.</td></tr>
<tr><td class="option-group" colspan="2">
<kbd><span class="option">--add-syntax-highlighting</span></kbd></td>
</tr>
<tr><td>&nbsp;</td><td>Add syntax highlighting in literal code
blocks. Default is no. Requires installation of
Pygments.</td></tr>
</tbody>
</table>
</div>
</div>
<div class="section">
<h1><a class="toc-backref" href="#id8" id="styles" name="styles">4&nbsp;&nbsp;&nbsp;Styles</a></h1>
<p><tt class="docutils literal"><span class="pre">odtwriter</span></tt> uses a number of styles that are defined in the
default <tt class="docutils literal"><span class="pre">styles.xml</span></tt>.  This section describes those styles.</p>
<p>You can modify the look of documents generated by <tt class="docutils literal"><span class="pre">odtwriter</span></tt> in
several ways:</p>
<ul>
<li><p class="first">Open (a copy of) <tt class="docutils literal"><span class="pre">styles.odt</span></tt> in <tt class="docutils literal"><span class="pre">OpenOffice/oowriter</span></tt> and
modify the style you wish to change. Now, save this document,
then generate your documents using this modified copy of
<tt class="docutils literal"><span class="pre">styles.odt</span></tt>.</p>
<p>In my version of <tt class="docutils literal"><span class="pre">oowriter</span></tt>, to modify styles, either (1)
press F11 or (2) use menu item &quot;Format/Styles and Formatting&quot;,
then right-click on the relevant style and select &quot;Modify&quot;.
Modify the style, then save your document.</p>
</li>
<li><p class="first">Open a document generated by <tt class="docutils literal"><span class="pre">odtwriter</span></tt> in <cite>oowriter`</cite>.  Now,
edit the style you are interested in modifying.  Now, you
can extract the styles.xml file from your document and either
(1) use this as your default styles file or (2) copy and paste
the relevant style definition into your styles.xml.</p>
</li>
<li><p class="first">Extract <tt class="docutils literal"><span class="pre">styles.xml</span></tt> from <tt class="docutils literal"><span class="pre">styles.odt</span></tt> using your favorite
<tt class="docutils literal"><span class="pre">zip/unzip</span></tt> tool.  Then modify <tt class="docutils literal"><span class="pre">styles.xml</span></tt> with a text
editor.  Now re-zip it back into your own <tt class="docutils literal"><span class="pre">styles.odt</span></tt>, or use
it directly by specifying it with a command line flag.
<strong>Hint:</strong> If you intend to extract <tt class="docutils literal"><span class="pre">styles.xml</span></tt> from an
<tt class="docutils literal"><span class="pre">.odt</span></tt> file (and then &quot;re-zip&quot; it), you should turn off XML
optimization/compression in <tt class="docutils literal"><span class="pre">oowriter</span></tt>.  In order to this in
<tt class="docutils literal"><span class="pre">oowriter</span></tt>, use Tools --&gt; Options... --&gt; Load-Save --&gt; General
and turn off &quot;Size optimization for XML format&quot;.</p>
</li>
<li><p class="first">Open an empty (or new) document in <tt class="docutils literal"><span class="pre">oowriter</span></tt>.  Define the
styles described in this section.  Then, use that document (a
.odt file) as your stylesheet.  <tt class="docutils literal"><span class="pre">odtwriter</span></tt> will extract the
<tt class="docutils literal"><span class="pre">styles.xml</span></tt> file from that document and insert it into the
output document.</p>
</li>
<li><p class="first">Some combination of the above.</p>
</li>
</ul>
<div class="section">
<h2><a class="toc-backref" href="#id9" id="styles-used-by-odtwriter" name="styles-used-by-odtwriter">4.1&nbsp;&nbsp;&nbsp;Styles used by odtwriter</a></h2>
<p>This section describes the styles used by <tt class="docutils literal"><span class="pre">odtwriter</span></tt>.</p>
<p>Note that we do not describe the &quot;look&quot; of these styles.  That can
be easily changed by using <tt class="docutils literal"><span class="pre">oowriter</span></tt> to edit the document
<tt class="docutils literal"><span class="pre">styles.odt</span></tt> (or a copy of it), and modifying any of the styles
described here.</p>
<p>To change the definition and appearance of these styles, open
<tt class="docutils literal"><span class="pre">styles.odt</span></tt> in <tt class="docutils literal"><span class="pre">oowriter</span></tt> and open the Styles and Formatting
window by using the following menu item:</p>
<pre class="literal-block">
Format --&gt; Styles and Formatting
</pre>
<p>Then, click on the Paragraph Styles button or the Character Styles
button at the top of the Styles and Formatting window.  You may
also need to select &quot;All Styles&quot; from the drop-down selection list
at the bottom of the Styles and Formatting window in order to see
the styles used by <tt class="docutils literal"><span class="pre">odtwriter</span></tt>.</p>
<p>Notice that you can make a copy of file <tt class="docutils literal"><span class="pre">styles.odt</span></tt>, modify it
using <tt class="docutils literal"><span class="pre">oowriter</span></tt>, and then use your copy with the
<tt class="docutils literal"><span class="pre">--stylesheet-path=&lt;file&gt;</span></tt> command line option.  Example:</p>
<pre class="literal-block">
$ rst2odt.py --stylesheet-path=mystyles.odt test2.txt test2.odt
</pre>
<div class="section">
<h3><a class="toc-backref" href="#id10" id="paragraph-styles" name="paragraph-styles">4.1.1&nbsp;&nbsp;&nbsp;Paragraph styles</a></h3>
<dl class="docutils">
<dt>rststyle-blockindent</dt>
<dd>An indented block.</dd>
<dt>rststyle-blockquote</dt>
<dd>A block quote.</dd>
<dt>rststyle-codeblock</dt>
<dd>Literal code blocks -- A block of example code.  Derived from
the <tt class="docutils literal"><span class="pre">Preformatted</span> <span class="pre">Text</span></tt> style in <tt class="docutils literal"><span class="pre">oowriter</span></tt>.</dd>
<dt>rststyle-heading{1|2|3|4|5}</dt>
<dd>Headings (sub-titles).  Five levels of sub-headings are
provided: rststyle-heading1 through rststyle-heading5.</dd>
<dt>rststyle-bodyindent</dt>
<dd>An indented block.</dd>
<dt>rststyle-bulletitem</dt>
<dd>An item in an bullet list.</dd>
<dt>rststyle-enumitem</dt>
<dd>An item in an enumerated list.</dd>
<dt>rststyle-horizontalline</dt>
<dd>A horizontal line, e.g. used for transitions.</dd>
<dt>rststyle-table-title</dt>
<dd>The style for titles of tables.  See section <a class="reference" href="#the-table-directive">The table
directive</a>.</dd>
<dt>rststyle-textbody</dt>
<dd>Normal text</dd>
</dl>
</div>
<div class="section">
<h3><a class="toc-backref" href="#id11" id="character-styles" name="character-styles">4.1.2&nbsp;&nbsp;&nbsp;Character styles</a></h3>
<dl class="docutils">
<dt>rststyle-emphasis</dt>
<dd>Emphasis.  Normally rendered as italics.</dd>
<dt>rststyle-inlineliteral</dt>
<dd>An inline literal.</dd>
<dt>rststyle-strong</dt>
<dd>Strong emphasis.  Normally rendered as boldface.</dd>
<dt>rststyle-quotation</dt>
<dd>In-line quoted material.</dd>
<dt>rststyle-codeblock-classname</dt>
<dd>Syntax highlighting in literal code blocks -- class names.</dd>
<dt>rststyle-codeblock-comment</dt>
<dd>Syntax highlighting in literal code blocks -- comments.</dd>
<dt>rststyle-codeblock-functionname</dt>
<dd>Syntax highlighting in literal code blocks -- function names.</dd>
<dt>rststyle-codeblock-keyword</dt>
<dd>Syntax highlighting in literal code blocks -- Python language
keywords.</dd>
<dt>rststyle-codeblock-name</dt>
<dd>Syntax highlighting in literal code blocks -- other names, for
example, variables.</dd>
<dt>rststyle-codeblock-number</dt>
<dd>Syntax highlighting in literal code blocks -- literal numbers,
including integers, floats, hex numbers, and octal numbers.</dd>
<dt>rststyle-codeblock-operator</dt>
<dd>Syntax highlighting in literal code blocks -- Python operators.</dd>
<dt>rststyle-codeblock-string</dt>
<dd>Syntax highlighting in literal code blocks -- literal strings.</dd>
</dl>
</div>
</div>
<div class="section">
<h2><a class="toc-backref" href="#id12" id="table-styles" name="table-styles">4.2&nbsp;&nbsp;&nbsp;Table styles</a></h2>
<p>Table styles are generated by <tt class="docutils literal"><span class="pre">oowriter</span></tt> for each table that you
create.  Therefore, <tt class="docutils literal"><span class="pre">odtwriter</span></tt> attempts to do something
similar.  These styles are created in the <tt class="docutils literal"><span class="pre">content.xml</span></tt> document
in the generated <tt class="docutils literal"><span class="pre">.odt</span></tt>.   These styles have names prefixed with
&quot;rststyle-Table&quot;.</p>
</div>
</div>
<div class="section">
<h1><a class="toc-backref" href="#id13" id="hints-and-suggestions" name="hints-and-suggestions">5&nbsp;&nbsp;&nbsp;Hints and Suggestions</a></h1>
<div class="section">
<h2><a class="toc-backref" href="#id14" id="table-of-contents" name="table-of-contents">5.1&nbsp;&nbsp;&nbsp;Table of contents</a></h2>
<p><tt class="docutils literal"><span class="pre">odtwriter</span></tt> can generate an outline style table of contents.
However, if you want an <tt class="docutils literal"><span class="pre">oowriter</span></tt> style table of contents along
with the formatting control that <tt class="docutils literal"><span class="pre">oowriter</span></tt> gives you, then you
may want to omit the <tt class="docutils literal"><span class="pre">..</span> <span class="pre">contents::</span></tt> directive and, after
generating your document, open it in <tt class="docutils literal"><span class="pre">oowriter</span></tt> and insert a
table of contents.   That feature is under menu item:</p>
<pre class="literal-block">
Insert --&gt; Indexes and Tables --&gt; Indexes and Tables
</pre>
</div>
<div class="section">
<h2><a class="toc-backref" href="#id15" id="syntax-highlighting" name="syntax-highlighting">5.2&nbsp;&nbsp;&nbsp;Syntax highlighting</a></h2>
<p><tt class="docutils literal"><span class="pre">odtwriter</span></tt> can add Python syntax highlighting to code in
literal code blocks.  In order to activate this, do both of the
following: (1) install Pygments and (2) use the command line flag
<tt class="docutils literal"><span class="pre">--add-syntax-highlighting</span></tt>.  Example:</p>
<pre class="literal-block">
$ rst2odt.py -g --add-syntax-highlight test.txt test.odt
</pre>
<p><strong>Caution:</strong> When <tt class="docutils literal"><span class="pre">odtwriter</span></tt> does syntax highlighting, by
default, it applies a Python lexer and Python syntax highlighting.
If you have literal code blocks that contain code which is <em>not</em>
Python code, then you likely to want either (1) to use the
<tt class="docutils literal"><span class="pre">..</span> <span class="pre">syntaxhighlight::</span></tt> directive to change the language/lexer or to
turn off highlighting across sections of your document or (2) to
<em>not</em> use the <tt class="docutils literal"><span class="pre">--add-syntax-highlighting</span></tt> flag.</p>
<p>You can find Pygments here: <a class="reference" href="http://pygments.pocoo.org/">Pygments</a>.</p>
<p>The following styles are defined in styles.odt and are used for
literal code blocks and syntax highlighting:</p>
<ul class="simple">
<li>Paragraph styles:<ul>
<li>rststyle-codeblock -- The style for the code block as a whole.</li>
</ul>
</li>
<li>Character styles:<ul>
<li>rststyle-codeblock-classname -- class names.</li>
<li>rststyle-codeblock-comment -- comments.</li>
<li>rststyle-codeblock-functionname -- function names.</li>
<li>rststyle-codeblock-keyword -- Python language keywords.</li>
<li>rststyle-codeblock-name -- other names, for example,
variables.</li>
<li>rststyle-codeblock-number -- literal numbers, including
integers, floats, hex numbers, and octal numbers.</li>
<li>rststyle-codeblock-operator -- Python operators.</li>
<li>rststyle-codeblock-string -- literal strings.</li>
</ul>
</li>
</ul>
<p>Each of the above styles has a default appearance that is defined
in <tt class="docutils literal"><span class="pre">styles.odt</span></tt>.  To change that definition and appearance, open
<tt class="docutils literal"><span class="pre">styles.odt</span></tt> in <tt class="docutils literal"><span class="pre">oowriter</span></tt> and use menu item:</p>
<blockquote>
Format --&gt; Styles and Formatting</blockquote>
<p>Then, click on the Paragraph Styles button or the Character Styles
button at the top of the Styles and Formatting window.  You may
also need to select &quot;All Styles&quot; from the drop-down selection list
at the bottom of the Styles and Formatting window.</p>
<div class="section">
<h3><a class="toc-backref" href="#id16" id="controlling-syntax-highlighting-within-a-document" name="controlling-syntax-highlighting-within-a-document">5.2.1&nbsp;&nbsp;&nbsp;Controlling syntax highlighting within a document</a></h3>
<p>By default, when you use the <tt class="docutils literal"><span class="pre">--add-syntax-highlighting</span></tt> command
line flag, syntax highlighting in literal blocks is on and the
Python lexer is used.  You can change this within your reST document
with the following directive:</p>
<pre class="literal-block">
.. syntaxhighlight newstate [lexer]
</pre>
<p>where:</p>
<ul class="simple">
<li><em>newstate</em> is either &quot;on&quot; or &quot;off&quot;, which makes highlighting
active or inactive.</li>
<li><em>lexer</em> is the Pygments lexer to use.  Change the lexer to match
the language in literal code blocks.  <em>lexer</em> should be one of
<em>aliases</em> listed at <a class="reference" href="http://pygments.pocoo.org/docs/lexers/">Pygments Available Lexers</a>, for example &quot;python&quot;,
&quot;pycon&quot;, &quot;java&quot;, &quot;cpp&quot;, &quot;c&quot;, &quot;perl&quot;, &quot;javascript&quot;, etc.</li>
</ul>
<p>Examples:</p>
<pre class="literal-block">
.. syntaxhighlight:: on python
.. syntaxhighlight:: off
.. syntaxhighlight:: on
.. syntaxhighlight:: on java
</pre>
<p>The syntax highlighting state and language/lexer set by this
directive remain in effect until the next directive is encountered
in the reST document.</p>
<p>Note to Pythonistas, there is a separate lexer for examples of
code from the Python interactive prompt and console output or
doctests.  The alias for that lexer is &quot;pycon&quot;.</p>
</div>
</div>
<div class="section">
<h2><a class="toc-backref" href="#id17" id="the-container-directive" name="the-container-directive">5.3&nbsp;&nbsp;&nbsp;The container directive</a></h2>
<p>There is limited support for the <tt class="docutils literal"><span class="pre">container</span></tt> directive.  The
limitations are the following:</p>
<ul class="simple">
<li>Only the first class in the list of classes (arguments) is used
and</li>
<li>That class/style must be a paragraph style and not (for example) a
character style.</li>
</ul>
<p>So, for example:</p>
<pre class="literal-block">
.. container:: style-1 style-2 style-3

    a block of text
</pre>
<p>Only <tt class="docutils literal"><span class="pre">style-1</span></tt> is used; <tt class="docutils literal"><span class="pre">style-2</span></tt> and <tt class="docutils literal"><span class="pre">style-3</span></tt> are ignored.
And, <tt class="docutils literal"><span class="pre">style-1</span></tt> must be a paragraph style.</p>
<p>To define a paragraph style, use the following menu item:</p>
<pre class="literal-block">
Format --&gt; Styles and Formatting
</pre>
<p>Then, click on the Paragraph Styles button.</p>
</div>
<div class="section">
<h2><a class="toc-backref" href="#id18" id="the-table-directive" name="the-table-directive">5.4&nbsp;&nbsp;&nbsp;The table directive</a></h2>
<p>The <tt class="docutils literal"><span class="pre">table</span></tt> directive can be used to add a title to a table.
Example:</p>
<pre class="literal-block">
.. table:: A little test table

    =========== =============
    Name        Value
    =========== =============
    Dave        Cute
    Mona        Smart
    =========== =============
</pre>
<p>The above will insert the title &quot;A little test table&quot; at the top of the
table.  You can modify the appearance of the title by modifying the
paragraph style <tt class="docutils literal"><span class="pre">rststyle-table-title</span></tt>.</p>
<!-- Configuration for Emacs -->
<!-- Local Variables:
mode: indented-text
indent-tabs-mode: nil
sentence-end-double-space: t
fill-column: 68
End: -->
</div>
</div>
</div>
<div class="footer">
<hr class="footer" />
<a class="reference" href="odtwriter.txt">View document source</a>.
Generated by <a class="reference" href="http://docutils.sourceforge.net/">Docutils</a> from <a class="reference" href="http://docutils.sourceforge.net/rst.html">reStructuredText</a> source.

</div>
</body>
</html>
