======================
Odtwriter for Docutils
======================

:Author: Dave Kuhlman
:address: dkuhlman@rexx.com
    http://www.rexx.com/~dkuhlman

:revision: 1.0a
:date: Aug. 30, 2006

:copyright: Copyright (c) 2006 Dave Kuhlman.  All Rights Reserved.
    This software is subject to the provisions of the MIT License
    http://www.opensource.org/licenses/mit-license.php.

:abstract: This document describes the Docutils odtwriter.

.. sectnum::

.. contents::



Introduction
============

What it does -- ``rst2odt.py/odtwriter.py`` translate reST
(reStructuredText) into a Open Document Format ``.odt`` file.  You
can learn more about here:

- `OASIS Open Document Format for Office Applications
  (OpenDocument) TC`_

- `Open Document at Wikipedia`_


How to Install It
=================

Requirements -- ``odtwriter`` requires:

- Python

- A sufficiently recent version of Docutils.

- Either of the following:

  - ElementTree -- See: http://effbot.org/zone/element-index.htm

  - Lxml -- See: http://codespeak.net/lxml/

  ``odtwriter`` will try first to use Lxml, and if it is not
  installed will use ElementTree.

Install ``odtwriter`` with the standard Python installation
commands::

    $ python setup.py build
    $ python setup.py install       # as root

This will install the odtwriter under ``docutils/writers/odtwriter``
within your Docutils installation.


How to Use It
=============

Run it from the command line as follows::

    $ rst2odt.py myinput.txt myoutput.odt

To see usage information and to learn about command line flags
that you can use, run the following::

    $ rst2odt.py --help

Examples::

    $ rst2odt.py -s -g python_comments.txt python_comments.odt

    $ rst2odt.py --source-url=odtwriter.txt --generator --stylesheet-path=/myconfigs/styles.odt odtwriter.txt odtwriter.odt


Styles
======

``odtwriter`` uses a number of styles that are defined in the
default ``styles.xml``.  This section describes those styles.

You can modify the look of documents generated by ``odtwriter`` in
several ways:

- Open (a copy of) ``styles.odt`` in ``oowriter``, modify the
  style you wish to change (in my version of ``oowriter``, do this
  with menu item ``Format/Styles and Formatting``), save this
  document, then generate your documents using this modified copy
  of ``styles.odt``.

- Open a document generated by ``odtwriter`` in `oowriter``.  Now,
  edit the style you are interested in modifying.  To do so either
  (1) press F11 or (2) use menu item "Format/Styles and
  Formatting", then right-click on the relevant style and select
  "Modify".  Modify the style, then save your document.  Now, you
  can extract the styles.xml file from your document and either
  (1) use this as your default styles file or (2) copy and paste
  the relevant style definition into your styles.xml.

- Extract ``styles.xml`` from ``styles.odt`` using your favorite
  ``zip/unzip`` tool.  Then modify ``styles.xml`` with a text
  editor.  Now re-zip it back into your own ``styles.odt``, or use
  it directly by specifying it with a command line flag.
  **Hint:** If you intend to extract ``styles.xml`` from an
  ``.odt`` file (and then "re-zip" it), you should turn off XML
  optimization/compression in ``oowriter``.  In order to this in
  ``oowriter``, use Tools --> Options... --> Load-Save --> General
  and turn off "Size optimization for XML format".

- Open an empty (or new) document in ``oowriter``.  Define the
  styles described in this section.  Then, use that document (a
  .odt file) as your stylesheet.  ``odtwriter`` will extract the
  ``styles.xml`` file from that document and insert it into the
  output document.

- Some combination of the above.


Styles used by odtwriter
------------------------

This section describes the styles used by ``odtwriter``.

Note that we do not describe the "look" of these styles.  That can
be easily changed by using ``oowriter`` to edit the document
``styles.odt`` (or a copy of it), and modifying any of the styles
described here.


Paragraph styles
~~~~~~~~~~~~~~~~

rststyle-blockindent
    An indented block.

rststyle-blockquote
    A block quote.

rststyle-codeblock
    A block of example code.  Derived from the ``Preformatted Text``
    style in ``oowriter``.

rststyle-heading{1|2|3|4|5}
    Headings (sub-titles).  Five levels of sub-headings are
    provided: rststyle-heading1 through rststyle-heading5.

rststyle-bodyindent
    An indented block.

rststyle-bulletitem
    An item in an bullet list.

rststyle-enumitem
    An item in an enumerated list.

rststyle-horizontalline
    A horizontal line, e.g. used for transitions.

rststyle-textbody
    Normal text

Character styles
~~~~~~~~~~~~~~~~

rststyle-emphasis
    Emphasis.  Normally rendered as italics.

rststyle-inlineliteral
    An inline literal.

rststyle-strong
    Strong emphasis.  Normally rendered as boldface.

rststyle-quotation
    In-line quoted material.




.. _`Open Document at Wikipedia`:
    http://en.wikipedia.org/wiki/OpenDocument

.. _`OASIS Open Document Format for Office Applications (OpenDocument) TC`:
    http://www.oasis-open.org/committees/tc_home.php?wg_abbrev=office






.. Configuration for Emacs
..
   Local Variables:
   mode: indented-text
   indent-tabs-mode: nil
   sentence-end-double-space: t
   fill-column: 68
   End:


