#!/usr/bin/env perl

# Filter artefacts from Docutils XML writer

while(defined($_ = <>)) {
  chomp();
  # Remove comment generated by Docutils XML writer
  next
      if /^<!-- Generated by Docutils/;
  # Collapse empty XML elements
  1 while s~<(\w+)(\s+[^>]*)?></\1>~<$1$2/>~;
  print("$_\n");
}
